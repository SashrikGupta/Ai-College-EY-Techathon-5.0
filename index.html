<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>University Portal Frontend</title>
  <style>
    /* Basic styling */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }
    header {
      background-color: #333;
      color: white;
      padding: 10px;
      text-align: center;
    }
    nav {
      background-color: #444;
      overflow: hidden;
    }
    nav button {
      background-color: #444;
      color: white;
      border: none;
      padding: 14px 16px;
      cursor: pointer;
      float: left;
      font-size: 16px;
    }
    nav button:hover {
      background-color: #ddd;
      color: black;
    }
    .container {
      padding: 20px;
    }
    .section {
      display: none;
      background: white;
      padding: 15px;
      border-radius: 4px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .section.active {
      display: block;
    }
    form {
      margin-bottom: 15px;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input[type="text"],
    input[type="email"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      max-width: 400px;
      padding: 8px;
      margin-top: 5px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 2px;
    }
    button[type="submit"] {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 2px;
    }
    button[type="submit"]:hover {
      background-color: #218838;
    }
    .result {
      padding: 10px;
      border: 1px solid #ccc;
      background: #eee;
      margin-top: 10px;
      max-width: 600px;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <header>
    <h1>University Portal Frontend</h1>
  </header>
  <nav>
    <button onclick="showSection('register')">Register</button>
    <button onclick="showSection('login')">Login</button>
    <button onclick="showSection('librarian')">Librarian</button>
    <button onclick="showSection('teacher')">Teacher</button>
    <button onclick="showSection('placement')">Placement</button>
  </nav>
  <div class="container">
    <!-- Register Section -->
    <div id="register" class="section">
      <h2>Register</h2>
      <form id="registerForm">
        <label>Username:</label>
        <input type="text" name="username" required>
        
        <label>Email:</label>
        <input type="email" name="email" required>
        
        <label>Age:</label>
        <input type="number" name="age" required>
        
        <label>Gender:</label>
        <select name="gender" required>
          <option value="">Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
        
        <label>Semester:</label>
        <input type="text" name="semester" required>
        
        <label>Weakness:</label>
        <textarea name="weakness" required></textarea>
        
        <label>Strength:</label>
        <textarea name="strength" required></textarea>
        
        <label>Resume:</label>
        <textarea name="resume" required></textarea>
        
        <button type="submit">Register</button>
      </form>
      <div id="registerResult" class="result"></div>
    </div>

    <!-- Login Section -->
    <div id="login" class="section">
      <h2>Login</h2>
      <form id="loginForm">
        <label>Email:</label>
        <input type="email" name="email" required>
        <button type="submit">Login</button>
      </form>
      <div id="loginResult" class="result"></div>
    </div>

    <!-- Librarian Section -->
    <div id="librarian" class="section">
      <h2>Librarian</h2>
      <!-- Add Material -->
      <div id="librarianAdd">
        <h3>Add Material</h3>
        <form id="librarianAddForm" enctype="multipart/form-data">
          <label>User ID:</label>
          <input type="text" name="userid" required>
          <label>Files (multiple allowed):</label>
          <input type="file" name="files" multiple required>
          <button type="submit">Upload Material</button>
        </form>
        <div id="librarianAddResult" class="result"></div>
      </div>
      <!-- Query Material -->
      <div id="librarianQuery">
        <h3>Query Material</h3>
        <form id="librarianQueryForm">
          <label>Prompt:</label>
          <textarea name="prompt" required></textarea>
          <button type="submit">Query</button>
        </form>
        <div id="librarianQueryResult" class="result"></div>
      </div>
      <!-- Delete Material -->
      <div id="librarianDelete">
        <h3>Delete Material</h3>
        <button id="librarianDeleteBtn">Delete All Material</button>
        <div id="librarianDeleteResult" class="result"></div>
      </div>
    </div>

    <!-- Teacher Section -->
    <div id="teacher" class="section">
      <h2>Teacher</h2>
      <!-- Ask Teacher -->
      <div id="teacherAsk">
        <h3>Ask Teacher</h3>
        <form id="teacherAskForm">
          <label>User ID:</label>
          <input type="text" name="userid" required>
          <label>Prompt:</label>
          <textarea name="prompt" required></textarea>
          <button type="submit">Ask</button>
        </form>
        <div id="teacherAskResult" class="result"></div>
      </div>
      <!-- Generate Test -->
      <div id="teacherGenerateTest">
        <h3>Generate Test</h3>
        <form id="teacherGenerateTestForm" enctype="multipart/form-data">
          <label>Upload PDF (context):</label>
          <input type="file" name="pdf" accept="application/pdf" required>
          <label>Prompt:</label>
          <textarea name="prompt" required></textarea>
          <button type="submit">Generate Test</button>
        </form>
        <div id="teacherGenerateTestResult" class="result"></div>
      </div>
      <!-- Evaluate Test -->
      <div id="teacherEvaluateTest">
        <h3>Evaluate Test</h3>
        <form id="teacherEvaluateTestForm" enctype="multipart/form-data">
          <label>Upload Answer Sheet:</label>
          <input type="file" name="answersheet" required>
          <label>User ID:</label>
          <input type="text" name="userid" required>
          <button type="submit">Evaluate Test</button>
        </form>
        <div id="teacherEvaluateTestResult" class="result"></div>
      </div>
    </div>

    <!-- Placement Section -->
    <div id="placement" class="section">
      <h2>Placement</h2>
      <div id="placementSearch">
        <h3>Search Placement</h3>
        <form id="placementSearchForm" enctype="multipart/form-data">
          <label>Upload Report:</label>
          <input type="file" name="report" required>
          <label>User ID:</label>
          <input type="text" name="userid" required>
          <label>Prompt:</label>
          <textarea name="prompt" required></textarea>
          <button type="submit">Search Placement</button>
        </form>
        <div id="placementSearchResult" class="result"></div>
      </div>
    </div>
  </div>

  <script>
    // Function to show one section and hide others
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(sectionId).classList.add('active');
    }
    // Initially show the Register section
    showSection('register');

    // ---------------------------
    // Registration
    // ---------------------------
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        username: form.username.value,
        email: form.email.value,
        age: parseInt(form.age.value),
        gender: form.gender.value,
        semester: form.semester.value,
        weakness: form.weakness.value,
        strength: form.strength.value,
        resume: form.resume.value
      };
      fetch('http://127.0.0.1:5000/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('registerResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('registerResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Login
    // ---------------------------
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const data = { email: form.email.value };
      fetch('http://127.0.0.1:5000/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('loginResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('loginResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Librarian - Add Material
    // ---------------------------
    document.getElementById('librarianAddForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData();
      // Append each selected file with the key 'files'
      Array.from(form.files.files).forEach(file => {
        formData.append('files', file);
      });
      // Append additional JSON data as a string field (the backend may need to parse it from request.form)
      formData.append('data', JSON.stringify({ userid: form.userid.value }));

      fetch('http://127.0.0.1:5000/librarian/add_material', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('librarianAddResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('librarianAddResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Librarian - Query Material
    // ---------------------------
    document.getElementById('librarianQueryForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const data = { prompt: form.prompt.value };
      fetch('http://127.0.0.1:5000/librarian/query_material', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('librarianQueryResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('librarianQueryResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Librarian - Delete Material
    // ---------------------------
    document.getElementById('librarianDeleteBtn').addEventListener('click', function() {
      fetch('http://127.0.0.1:5000/librarian/delete', {
        method: 'POST'
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('librarianDeleteResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('librarianDeleteResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Teacher - Ask Teacher
    // ---------------------------
    document.getElementById('teacherAskForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        userid: form.userid.value,
        prompt: form.prompt.value
      };
      fetch('http://127.0.0.1:5000/teacher/ask', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('teacherAskResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('teacherAskResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Teacher - Generate Test
    // ---------------------------
    document.getElementById('teacherGenerateTestForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData();
      formData.append('pdf', form.pdf.files[0]);
      formData.append('data', JSON.stringify({ prompt: form.prompt.value }));
      console.log(form.prompt.value)
      fetch('http://127.0.0.1:5000/teacher/generate_test', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('teacherGenerateTestResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('teacherGenerateTestResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Teacher - Evaluate Test
    // ---------------------------
    document.getElementById('teacherEvaluateTestForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData();
      formData.append('answersheet', form.answersheet.files[0]);
      formData.append('data', JSON.stringify({ userid: form.userid.value }));

      fetch('http://127.0.0.1:5000/teacher/evaluate_test', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('teacherEvaluateTestResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('teacherEvaluateTestResult').innerText = 'Error: ' + error;
      });
    });

    // ---------------------------
    // Placement - Search Placement
    // ---------------------------
    document.getElementById('placementSearchForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData();
      formData.append('report', form.report.files[0]);
      formData.append('data', JSON.stringify({
        userid: form.userid.value,
        prompt: form.prompt.value
      }));

      fetch('http://127.0.0.1:5000/placement/search', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json().then(json => ({ status: res.status, body: json })))
      .then(result => {
        document.getElementById('placementSearchResult').innerText = JSON.stringify(result.body, null, 2);
      })
      .catch(error => {
        document.getElementById('placementSearchResult').innerText = 'Error: ' + error;
      });
    });
  </script>
</body>
</html>
